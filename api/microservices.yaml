# yaml-language-server: $schema=https://raw.githubusercontent.com/reubenmiller/go-c8y-cli/feat/extensions-manager/tools/schema/extensionCommands.json
---
group:
  name: microservices
  description: Manage microservices

# Use can use yaml anchors to reduce the amount of boilerplate
x-types-microservice: &type-microservice
  type: string
  description: Microservice. It support a custom completion/lookup using other c8y commands
  pipeline: true
  completion:
    type: external
    command:
      - c8y
      - bpl
      - microservices
      - list
      - --query
      - "name eq '%s*'"
      - --select=name
  lookup:
    type: external
    command:
      - c8y
      - bpl
      - microservices
      - list
      - --query
      - "name eq '%s*'"
      - --select=id
commands:
  - name: list
    description: List microservices
    descriptionLong: List all microservices
    method: GET
    path: /application/applications
    exampleList:
      - command: c8y %[1]s microservices list
        description: Get list of microservices
    queryParameters:
      - name: type
        pipeline: true
        type: string
        validationSet: [ APAMA_CEP_RULE, EXTERNAL, HOSTED, MICROSERVICE ]
        description: Application type

      - name: name
        type: applicationname
        description: The name of the application.

      - name: owner
        type: tenantname
        description: The ID of the tenant that owns the applications.

      - name: providedFor
        type: tenantname
        description: The ID of a tenant that is subscribed to the applications but doesn't own them.

      - name: subscriber
        type: tenantname
        description: The ID of a tenant that is subscribed to the applications.

      - name: user
        type: '[]user'
        description: The ID of a user that has access to the applications.